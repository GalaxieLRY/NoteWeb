---
title: 【栈】字符串解码
date: 2025-09-03
---


## 题目：

题目链接：[394. 字符串解码](https://leetcode.cn/problems/decode-string/description/?envType=study-plan-v2&envId=top-100-liked)

题目描述：

> 给定一个经过编码的字符串，返回它解码后的字符串。
> 编码规则为: `k[encoded_string]`，表示其中方括号内部的 `encoded_string` 正好重复 `k` 次。注意 `k` 保证为正整数。
> 你可以认为输入字符串总是有效的；输入字符串中没有额外的空格，且输入的方括号总是符合格式要求的。
> 此外，你可以认为原始数据不包含数字，所有的数字只表示重复的次数 `k` ，例如不会出现像 `3a` 或 `2[4]` 的输入。
> 测试用例保证输出的长度不会超过 $10^5$。

## 思路：

**主要看代码**

(【栈】字符串解码-思路)[./图片/【栈】字符串解码-思路.png]

## 代码：

```c++
class Solution {
public:
    // size_t 是为 “描述内存大小和索引” 设计的专用无符号类型，
    // 核心价值在于可移植性和与系统位数的适配性。
    string getDigits(string &s, size_t &ptr){   
        string ret = "";
        while(isdigit(s[ptr])){
            ret.push_back(s[ptr++]);
        }
        return ret;
    }

    string getString(vector<string>&s){
        string ret="";
        for(auto &x:s){
            ret += x;
        }
        return ret;
    }

    string decodeString(string s) {
        vector<string> stk;
        size_t ptr=0;

        while(ptr < s.size()){
            char cur=s[ptr];
            if(isdigit(cur)){
                // 获取一个数字并入栈
                string digits = getDigits(s,ptr);
                stk.push_back(digits);
            }else if(isalpha(cur) || cur == '['){
                // 获取一个字母并入栈
                stk.push_back(string(1, s[ptr++])); // 将单个字符转换为字符串，再入栈
            }else{
                // 现在遇到了右括号 ] 
                ++ptr;
                vector<string> sub;
                while(stk.back() != "["){
                    sub.push_back(stk.back());
                    stk.pop_back();
                }
                reverse(sub.begin(), sub.end());
                // 左括号出栈
                stk.pop_back();
                // 此时stk栈顶为当前sub对应的字符串应该出现的次数
                int repTime = stoi(stk.back()); // 字符串转为整数
                stk.pop_back();
                string t,o = getString(sub);
                // 构造字符串
                while(repTime--)t += o;
                // 将构造好的字符串入栈
                stk.push_back(t);
            }
        }

        return getString(stk);
    }
};
```